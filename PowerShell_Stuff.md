Get process vs port  
```
Get-NetTCPConnection | foreach {$PPID = $_.OwningProcess; $PORT = $_.LocalPort; $ADDR = $_.LocalAddress; $PROC = $(Get-Process -Id $PPID); $PROCName = $PROC.ProcessName; $PROCPath = $PROC.Path; Write-Output "$ADDR : $PORT --> $PROCName    $PROCPath"}
```

# AMSI Bypass
- [reigningshells powershell bypasses](https://gist.github.com/reigningshells/a255fcca07465befbcbf4be9cdf67560)
- [S3cur3Th1sSh1t Amsi Bypass](https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell)


# Access a mailbox from powershell
### This assumes you are in a powershell context running as a user with a mailbox and the Exchange server has web services exposed
```
Import-Module -Name "C:\Program Files\Microsoft\Exchange Server\V15\Bin\Microsoft.Exchange.WebServices.dll"
$ExchangeService = New-Object Microsoft.Exchange.WebServices.Data.ExchangeService
$WellKnownFolderName = [Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::Inbox
$ExchangeService.Url = 'https://<EXCHANGE-SERVER>/EWS/Exchange.asmx'
$view = New-Object Microsoft.Exchange.WebServices.Data.ItemView(100);
[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}
$ExchangeService.FindItems('Inbox', $view)
```
For further details check out [Microsoft's Exchange Web Services API](https://learn.microsoft.com/en-us/dotnet/api/microsoft.exchange.webservices.data?view=exchange-ews-api). E.g [FindItem](https://learn.microsoft.com/en-us/dotnet/api/microsoft.exchange.webservices.data.folder.finditems?view=exchange-ews-api#microsoft-exchange-webservices-data-folder-finditems(microsoft-exchange-webservices-data-searchfilter-microsoft-exchange-webservices-data-itemview))  
More MS stuff at [Develop web service clients for Exchange](https://learn.microsoft.com/en-us/exchange/client-developer/exchange-web-services/develop-web-service-clients-for-exchange)
